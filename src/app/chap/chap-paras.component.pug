div(*ngIf='chap')
  //sticky.operations.ui.right.floated.header([sticky-offset-top]="10")
  .sticky.ui.right.floated.header
    .operations([hidden]='annotateOnly')
      i.paragraph.icon
      | 段落
      button.ui.mini.button(*ngIf='!first', (click)='mergeUp()')
        i.chevron.up.icon
        | 向上合并
      button.ui.mini.button(*ngIf='!last', (click)='mergeDown()')
        i.chevron.down.icon
        | 向下合并
      button.ui.mini.button((click)='remove()')
        i.remove.icon
        | 删除
      button.ui.mini.button((click)='insertBefore()', data-tooltip="Insert Before")
        i.add.icon
        | 插入
      //button.ui.mini.button((click)='continuousEditing=!continuousEditing', data-tooltip="Continuous Inserting/Appending")
        i.write.icon
        i.toggle.icon([ngClass]='continuousEditing? "on":"off"')
        | Continuous
      sui-checkbox([(ngModel)]='continuousEditing') 连续插入/新增
      //button.ui.mini.button((click)='splitMode=!splitMode', data-tooltip="Split a Paragraph When Input an Empty Line")
        i.paragraph.icon
        i.toggle.icon([ngClass]='splitMode? "on":"off"')
        | Split
      sui-checkbox([(ngModel)]='splitMode') 空行分段
    .operations([hidden]='annotateOnly')
      i.write.icon
      | 编辑
      button.ui.mini.button((click)='edit()')
        i.edit.icon
        | 编辑
      //button.ui.mini.button((click)='clickToEdit=!clickToEdit', data-tooltip="Go into Edit on Clicking")
        i.hand.pointer.icon
        i.toggle.icon([ngClass]='{"on": clickToEdit, "off": !clickToEdit}')
        | Click to Edit
      sui-checkbox([(ngModel)]='clickToEdit') 选中即编辑
      //button.ui.mini.button((click)='editInplace=!editInplace')
        i.text.cursor.icon
        i.toggle.icon([ngClass]='editInplace? "on":"off"')
        | Edit Inplace
      sui-checkbox([(ngModel)]='editInplace') 原地编辑
      //button.ui.mini.button((click)='annotating=!annotating')
        i.text.cursor.icon
        i.toggle.icon([ngClass]='annotating? "on":"off"')
        | Annotate
      sui-checkbox([(ngModel)]='annotating') 标注

    .annotations.operations(*ngIf='annotating')
      i.text.cursor.icon
      | 标注
      .ui.basic.mini.buttons(*ngFor='let agroup of groupedAnnotations')
        .ui.mini.button(*ngFor='let ann of agroup.annotations', [ngClass]='{active: ann.name===currentAnnotation}', (click)='switchAnnotation(ann.name)')
          span(class='{{ann.cssClass}}') {{ann.name}}
      .ui.right.floated.header
        sui-checkbox([(ngModel)]='annotateOnly') 隐藏其他

  .ui.list.items
    ng-template(ngFor='', let-para='', [ngForOf]="chap.paras", let-index="index", let-first="first", let-last="last", [ngForTrackBy]="paraTracker")
      .item.paragraph(*ngIf='index===insertPos')
        .ui.left.floated.mini.statistic.para-no
          .value +
        para-form.ui.form.content((onSave)="save($event)", (onCancel)="cancelEdit()")
      .item.paragraph
        .ui.left.floated.mini.statistic.para-no((click)='selectPara2(para)')
          .value {{index+1}}
        para-content.para-content([content]='para.content',
        [gotFocus]='para===selectedPara',
        [editable]='editInplace',
        [annotating]='annotating',
        [annotation]='currentAnnotation',
        [ngClass]='{"selected": para===selectedPara}',
        [hidden]='editingPara===para',
        (click)='selectPara(para)',
        (contentChange)="onContentChange(para,$event)",
        (contentCommand)="onContentCommand(para,$event)")
          //.right.floated(*ngIf='editButtons')
            button.ui.mini.button(*ngIf='!first', (click)='mergeUp(para)')
              i.chevron.up.icon

        para-form.ui.form.content(*ngIf='editingPara===para', [para]='para', (onSave)="save($event)", (onCancel)="cancelEdit()")

    .item.paragraph(*ngIf='insertPos===chap.paras.length')
      .ui.left.floated.mini.statistic.para-no
        .value +
      para-form.ui.form.content((onSave)="save($event)", (onCancel)="cancelEdit()")

  .ui.clearing.hidden.divider
  .ui.right.floated.header([hidden]='insertPos==chap.paras.length')
    button.ui.small.button((click)='append()') 新增

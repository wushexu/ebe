div(*ngIf='chap')
  sticky.ui.right.floated.header.opertions([sticky-offset-top]="10")
    button.ui.tiny.primary.basic.button(*ngIf='!first', (click)='mergeUp()')
      i.chevron.up.icon
      | Merge Up
    button.ui.tiny.primary.basic.button(*ngIf='!last', (click)='mergeDown()')
      i.chevron.down.icon
      | Merge Down
    button.ui.tiny.primary.basic.button((click)='insertBefore()')
      i.add.icon
      | Insert Before
    button.ui.tiny.primary.basic.button((click)='edit()')
      i.edit.icon
      | Edit
    button.ui.tiny.primary.basic.button((click)='remove()')
      i.remove.icon
      | Remove
    button.ui.tiny.primary.basic.button((click)='editButtons=!editButtons')
      i.toggle.icon([ngClass]='{"on": editButtons, "off": !editButtons}')
      | Toggle Button

  .ui.list.items
    ng-template(ngFor='', let-para='', [ngForOf]="chap.paras", let-index="index", let-first="first", let-last="last", [ngForTrackBy]="paraTracker")
      .item.paragraph(*ngIf='index===insertPos')
        .ui.left.floated.mini.statistic.para-no
          .value +
        .ui.form.content
          .fields
            .eight.wide.field
              textarea(rows='3', #insertPara='')
            .field
              button.ui.small.button((click)='this.insertPos=null') Cancel
            .field
              button.ui.small.primary.button((click)="saveInsert(insertPara.value); insertPara.value=''")
                | Save
      .item.paragraph
        .ui.left.floated.mini.statistic.para-no((click)='selectPara2(para)')
          .value {{index+1}}
        .para-content([ngClass]='{"selected": para===selectedPara}', [hidden]='editingPara===para', (click)='selectPara(para)')
          .right.floated(*ngIf='editButtons')
            button.ui.mini.button(*ngIf='!first', (click)='mergeUp(para)')
              i.chevron.up.icon
            button.ui.mini.button(*ngIf='!last', (click)='mergeDown(para)')
              i.chevron.down.icon
            button.ui.mini.button((click)='insertBefore(para)')
              i.add.icon
            button.ui.mini.button((click)='edit(para)')
              i.edit.icon
            button.ui.mini.button((click)='remove(para)')
              i.remove.icon

          .pre-wrap([innerHTML]='para.content')

        .ui.form.content(*ngIf='editingPara===para')
          .fields
            .twelve.wide.field
              textarea(#paraContent='') {{para.content}}
            .field
              button.ui.small.button((click)='this.editingPara=null') Cancel
            .field
              button.ui.small.primary.button((click)='save(paraContent.value)') Save

  .ui.hidden.divider
  .ui.form
    .field
      label New:
    .two.fields
      .field
        textarea(rows='3', #newPara='')
      .field
        button.ui.small.primary.button((click)="append(newPara.value); newPara.value=''")
          | Append
